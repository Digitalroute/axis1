<?xml version="1.0" encoding="UTF-8"?>

<!-- $Revision: 1.21 $ $Date: 2004-10-27 20:54:09 +0600 (Wed, 27 Oct 2004) $ -->

<project default="jar"
    xmlns:j="jelly:core"
    xmlns:maven="jelly:maven"
    xmlns:deploy="deploy"
    xmlns:ant="jelly:ant">
    <postGoal name="test:compile">
        <j:jelly xmlns="jelly:ant">
		<ant:ant antfile="build.xml" inheritall="true" inheritrefs="true" dir="src/samples/general/sample1"/>
		<ant:ant antfile="build.xml" inheritall="true" inheritrefs="true" dir="src/samples/deployment/service1"/>
		<ant:ant antfile="build.xml" inheritall="true" inheritrefs="true" dir="src/samples/deployment/service2"/>
		<ant:ant antfile="build.xml" inheritall="true" inheritrefs="true" dir="src/samples/deployment/module1"/>
		<ant:ant antfile="build.xml" inheritall="true" inheritrefs="true" dir="src/samples/deployment/module2"/>
    		<ant:ant antfile="build.xml" inheritall="true" inheritrefs="true" dir="src/samples/encoding/sample1"/>
	</j:jelly>
      <ant:copy file="${basedir}/src/test-resources/deployment/server.xml" tofile="${basedir}/target/test-resources/deployment/server.xml"/>
    </postGoal> 
	<postGoal name="jar">
        <ant:mkdir dir="${maven.repo.local}/axis/jars"/>
		<ant:copy file="${basedir}/target/axis2-M1.jar" tofile="${maven.repo.local}/axis/jars/axis2-M1.jar"/>
     </postGoal>
    <goal name="war" prereqs="jar">
        <!-- jar the test classes -->
        <jar destfile="target/axis2-test.jar" basedir="target/test-classes"/>
		<war destfile="target/axis2.war" webxml="src/conf/web.xml">
		  <fileset dir="src/html"/>
		  <lib dir="${maven.repo.local}/stax/jars/">
		    <include name="stax-api-1.0.jar"/>
		    <include name="stax-1.1.1-dev.jar"/>		    
		  </lib>  
		  <lib dir="${maven.repo.local}/commons-logging/jars/">
		    <include name="commons-logging-1.0.3.jar"/>
		  </lib>  
		  <lib dir="${maven.repo.local}/axis/jars/">
		    <include name="axis-wsdl4j-1.2-RC1.jar"/>
		  </lib>  
		  <lib dir="${maven.repo.local}/log4j/jars/">
		    <include name="log4j-1.2.8.jar"/>
		  </lib>  
		  <lib dir="target/">
		    <include name="axis2*.jar"/>
		  </lib>  
		</war>
    </goal>
    
    <goal name="samples">
    		<ant:ant antfile="build.xml" inheritall="true" inheritrefs="true" dir="src/samples/encoding/sample1"/>
    		<ant:ant antfile="build.xml" inheritall="true" inheritrefs="true" dir="src/samples/encoding/sample2"/>
    </goal>
 </project>
